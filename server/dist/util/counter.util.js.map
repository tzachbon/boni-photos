{"version":3,"file":"counter.util.js","sourceRoot":"","sources":["../../src/util/counter.util.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,wDAA6B;AAC7B,yCAAqC;AAErC;IAME;QALQ,WAAM,GAAW,CAAC,CAAC;QACnB,UAAK,GAAW,CAAC,CAAC;QAClB,QAAG,GAAW,CAAC,CAAC;QAItB,mBAAI,CAAC,QAAQ,CAAC,eAAe,EAAE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACjE,mBAAI,CAAC,QAAQ,CAAC,gBAAgB,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;IACpE,CAAC;IAEK,mCAAiB,GAAvB;;;;;;wBACQ,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC,QAAQ,EAAE,CAAC;wBAC9B,IAAI,GAAG,+EAEX,KAAK,6EACQ,IAAI,CAAC,MAAM,4HAGvB,IAAI,CAAC,GAAG,WACV,CAAA;wBACK,WAAW,GAAG,IAAI,kBAAM,CAAC,uDAAa,IAAI,CAAC,MAAM,0CAAS,EAAE,IAAI,CAAC,CAAC;wBACxE,WAAM,WAAW,CAAC,IAAI,EAAE,EAAA;;wBAAxB,SAAwB,CAAC;wBACzB,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;;;;;KACxB;IAEK,kCAAgB,GAAtB;;;;;;wBACQ,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC,QAAQ,EAAE,CAAC;wBAC9B,IAAI,GAAG,+EAEX,KAAK,sEACM,IAAI,CAAC,KAAK,4EACT,IAAI,CAAC,MAAM,6EACV,IAAI,CAAC,GAAG,WACtB,CAAA;wBACK,WAAW,GAAG,IAAI,kBAAM,CAAC,iDAAY,IAAI,CAAC,KAAK,0CAAS,EAAE,IAAI,CAAC,CAAC;wBACtE,WAAM,WAAW,CAAC,IAAI,EAAE,EAAA;;wBAAxB,SAAwB,CAAC;wBACzB,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;;;;;KACvB;IAED,gCAAc,GAAd,UAAe,MAAM;QACnB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACvB,CAAC;IAED,+BAAa,GAAb,UAAc,KAAK;QACjB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACrB,CAAC;IAED,+BAAa,GAAb;QACE,IAAI,CAAC,KAAK,EAAE,CAAC;QACb,IAAI,CAAC,MAAM,EAAE,CAAC;QACd,IAAI,CAAC,GAAG,EAAE,CAAC;IACb,CAAC;IAED,sBAAI,gCAAW;aAAf;YACE,OAAO,IAAI,CAAC,GAAG,CAAC;QAClB,CAAC;;;OAAA;IAED,sBAAI,gCAAW;aAAf;YACE,OAAO,IAAI,CAAC,MAAM,CAAC;QACrB,CAAC;;;OAAA;IAED,sBAAI,+BAAU;aAAd;YACE,OAAO,IAAI,CAAC,KAAK,CAAC;QACpB,CAAC;;;OAAA;IACH,cAAC;AAAD,CAAC,AAjED,IAiEC;AAjEY,0BAAO","sourcesContent":["import cron from 'node-cron';\nimport { Mailer } from './mail.util';\n\nexport class Counter {\n  private weekly: number = 0;\n  private daily: number = 0;\n  private sum: number = 0;\n\n\n  constructor() {\n    cron.schedule('25 5 10 * * *', this.sendMailEveryDay.bind(this));\n    cron.schedule('0 0 12 * * FRI', this.sendMailEveryWeek.bind(this))\n  }\n\n  async sendMailEveryWeek() {\n    const today = new Date().toString();\n    const text = `\n    נכון לעכשיו:\n    ${today}\n     נכנסו השבוע ${this.weekly}\n\n     סך הכל נכנסו למערכת:\n     ${this.sum}\n    `\n    const MailToAdmin = new Mailer(`השבוע היו ${this.weekly} כניסות`, text);\n    await MailToAdmin.send();\n    this.setWeeklyCount(0);\n  }\n\n  async sendMailEveryDay() {\n    const today = new Date().toString();\n    const text = `\n    נכון לעכשיו:\n    ${today}\n    נכנסו היום ${this.daily}\n    נכנסו השבוע ${this.weekly}\n    נכנסו סך הכל ${this.sum}\n    `\n    const MailToAdmin = new Mailer(`היום היו ${this.daily} כניסות`, text);\n    await MailToAdmin.send();\n    this.setDailyCount(0);\n  }\n\n  setWeeklyCount(weekly) {\n    this.weekly = weekly;\n  }\n\n  setDailyCount(daily) {\n    this.daily = daily;\n  }\n\n  updateCounter() {\n    this.daily++;\n    this.weekly++;\n    this.sum++;\n  }\n\n  get totalEnters() {\n    return this.sum;\n  }\n\n  get weeklyCount() {\n    return this.weekly;\n  }\n\n  get dailyCount() {\n    return this.daily;\n  }\n}\n"]}